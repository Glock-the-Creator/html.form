<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intro to HTML Forms (Bootstrap Version)</title>

    <!--Adding Bootstrap CSS. Earlier: this part had used default browser styles. Now: Bootstrap uses a grid system and form + button styles.-->
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
    >
</head>

<!--Using Bootstrap's light classes. Earlier: body had no styling at all. Now: bg light gives a light gray background and ensures full-height layout.-->
<body class="bg-light min-vh-100 d-flex align-items-center">

    <!--Bootstrap container centers content and adds horizontal padding. Earlier: elements were flush to the page edge with no margins.-->
    <div class="container">
        <div class="row justify-content-center">
            <!--Using col to keep the form a reasonable width on larger screens and full-width on small screens.-->
            <div class="col-md-6">

                <!--Card cfunction to visually group the form. Before: header and form simply stacked with no visual separation. Now: card adds padding, border, and shadow.-->
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h1 class="h3 mb-4 text-center">Intro to HTML Forms</h1>

                        <!--Using Bootstrap's form classes to style the form. Earlier: form tag had no classes, fields were cramped together. Now: spacing is controlled using margin utility classes.-->
                        <form id="myForm">
                            <!--Earlier: plain input elements with placeholder only. Now: labels are more accessibile, and form control makes inputs full-width with consistent padding and borders.-->
                            <div class="mb-3">
                                <label for="username" class="form-label">Username</label>
                                <input
                                    type="text"
                                    id="username"
                                    name="username"
                                    class="form-control"
                                    placeholder="Enter Username"
                                    required
                                >
                            </div>

                            <div class="mb-3">
                                <label for="email" class="form-label">Email</label>
                                <input
                                    type="email"
                                    id="email"
                                    name="email"
                                    class="form-control"
                                    placeholder="Enter Email"
                                    required
                                >
                            </div>

                            <div class="mb-3">
                                <label for="password" class="form-label">Password</label>
                                <input
                                    type="password"
                                    id="password"
                                    name="password"
                                    class="form-control"
                                    placeholder="Enter Password"
                                    required
                                >
                            </div>

                            <!--btn primary: Earlier: the button was an plain HTML button. Now: Bootstrap button classes give it a primary color, padding, and rounded corners.-->
                            <button type="submit" class="btn btn-primary w-100">
                                Submit
                            </button>
                        </form>

                        <!-- Horizontal rule replaced by Bootstrap spacing utilities -->
                        <!-- Earlier: hr was used to separate content. Now: mt4 adds spacing without an extra line. -->
                        <div id="output" class="mt-4"></div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js">
    </script>

    <script>
        const HARD_CODED_PASSWORD = "glocksine";

        const form = document.getElementById("myForm");
        const outputDiv = document.getElementById("output");

        form.addEventListener("submit", async function (e) {
            e.preventDefault();

            const username = form.username.value;
            const email = form.email.value;
            const password = form.password.value;

            const hashedPassword = await hashPassword(password);

            let loginMessage = "";

            if (password.toLowerCase() === HARD_CODED_PASSWORD.toLowerCase()) {
                loginMessage = "Successful Login";
            } else {
                loginMessage = "Password Mismatch";
            }

            /* Using Bootstrap alert classes for the output. Earlier: output was plain text in a div. Now: alert alert-info makes the result visible and styled, while mt3 keeps spacing with the form. */
            outputDiv.className = "alert alert-info mt-3";
            outputDiv.textContent =
                `Username: ${username}, Email: ${email}, Password: ${password}, ` +
                `Hashed Password: ${hashedPassword}, Status: ${loginMessage}`;
        });

        async function hashPassword(password) {
            const encoder = new TextEncoder();
            const data = encoder.encode(password);

            const hashBuffer = await crypto.subtle.digest("SHA-256", data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray
                .map(b => b.toString(16).padStart(2, "0"))
                .join("");

            return hashHex;
        }
    </script>
</body>
</html>

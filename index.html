<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intro to HTML Forms</title>
</head>

<body>

<h1>Intro to HTML Forms</h1>

<form id="myForm">
    <input type="text" name="username" placeholder="Enter Username" required>
    <input type="email" name="email" placeholder="Enter Email" required>
    <input type="password" name="password" placeholder="Enter Password" required>

    <button type="submit">Submit</button>
</form>

<hr>

<div id="output"></div>

<script>
    const HARD_CODED_PASSWORD = "glocksine";

    const form = document.getElementById("myForm");

    form.addEventListener("submit", async function(e) {
        e.preventDefault();

        const username = form.username.value;
        const email = form.email.value;
        const password = form.password.value;

        const hashedPassword = await hashPassword(password);

        let loginMessage = "";

        if (password.toLowerCase() === HARD_CODED_PASSWORD.toLowerCase()) {
            loginMessage = "Successful Login";
        } else {
            loginMessage = "Password Mismatch";
        }
        
        document.getElementById("output").textContent =
            `Username: ${username}, Email: ${email}, Password: ${password}, ` +
            `Hashed Password: ${hashedPassword}, Status: ${loginMessage}`;
    });
    
    async function hashPassword(password) {
        const encoder = new TextEncoder();
        const data = encoder.encode(password);

        const hashBuffer = await crypto.subtle.digest("SHA-256", data);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        const hashHex = hashArray
            .map(b => b.toString(16).padStart(2, "0"))
            .join("");

        return hashHex;
    }
</script>

</body>
</html>
